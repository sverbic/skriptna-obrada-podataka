
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Obrada tabelarnih podataka u Pajtonu &#8212; Skriptna obrada i analiza podataka u Pajtonu</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Eksplorativna analiza podataka" href="2%20Eksplorativna%20analiza%20podataka.html" />
    <link rel="prev" title="Uvod" href="0%20Uvod.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Skriptna obrada i analiza podataka u Pajtonu</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Skriptna obrada i analiza podataka u Pajtonu
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="0%20Uvod.html">
   Uvod
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Obrada tabelarnih podataka u Pajtonu
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2%20Eksplorativna%20analiza%20podataka.html">
   Eksplorativna analiza podataka
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3%20%C4%8Ci%C5%A1%C4%87enje%20podataka%20u%20Pajtonu.html">
   Čišćenje podataka u Pajtonu
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="4%20Priprema%20i%20deskriptivna%20analiza%20numeri%C4%8Dkih%20podataka.html">
   Priprema i deskriptivna analiza numeričkih podataka
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5%20Vizuelizacija%20podataka%20na%20geografskoj%20mapi.html">
   Vizuelizacija podataka na geografskoj mapi
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="6%20Ma%C5%A1inska%20obrada%20tekstualnih%20podataka.html">
   Mašinska obrada tekstualnih podataka
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="7%20Koeficijent%20korelacije.html">
   Koeficijent korelacije
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="8%20Kvantifikacija%20sli%C4%8Dnosti%20i%20razlika%20slo%C5%BEenih%20objekata.html">
   Kvantifikacija sličnosti i razlika složenih objekata
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="9%20Fitovanje%20podataka.html">
   Fitovanje podataka
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="10%20Vi%C5%A1estruka%20linearna%20regresija.html">
   Višestruka linearna regresija
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="11%20Stablo%20odlu%C4%8Divanja.html">
   Stablo odlučivanja
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="12%20Klasterska%20analiza.html">
   Klasterska analiza
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/1 Obrada tabelarnih podataka u Pajtonu.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F1 Obrada tabelarnih podataka u Pajtonu.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/1 Obrada tabelarnih podataka u Pajtonu.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nizovi-i-tabele">
   Nizovi i tabele
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tabela-tipa-dataframe">
   Tabela tipa
   <em>
    DataFrame
   </em>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tabela-kao-lista-vrsta">
     Tabela kao lista vrsta
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tabela-kao-recnik-kolona">
     Tabela kao rečnik kolona
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pristupanje-elementima-tabele">
     Pristupanje elementima tabele
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pristupnici-eng-accessors">
     Pristupnici (eng.
     <em>
      accessors
     </em>
     )
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ucitavanje-velike-tabele-sa-podacima">
   Učitavanje velike tabele sa podacima
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#izbor-kolona">
   Izbor kolona
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tabulacija">
   Tabulacija
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#kros-tabulacija">
     Kros-tabulacija
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sortiranje">
   Sortiranje
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#filtriranje-redova-i-selekcija-kolona">
   Filtriranje redova i selekcija kolona
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#slozeni-kriterijumi">
     Složeni kriterijumi
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#agregacija-podataka">
   Agregacija podataka
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#povezivanje-tabela">
   Povezivanje tabela
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#snimanje-podataka">
   Snimanje podataka
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="obrada-tabelarnih-podataka-u-pajtonu">
<h1>Obrada tabelarnih podataka u Pajtonu<a class="headerlink" href="#obrada-tabelarnih-podataka-u-pajtonu" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p>U ovoj svesci je prikazano kako upravljamo tabelama, odnosno kako raspodeljujemo, filtriramo, sortiramo ili na neki drugi način obrađujemo podatke koji su organizovani u tabele. Uvedena je osnovna struktura za rad sa podacima u Pajtonu (<em>DataFrame</em>) i dati su primeri korišćenja najvažnijih Pajton funkcija za rad sa tabelama.</p>
</div></blockquote>
<p>Obrada podataka podrazumeva tehnički deo rada sa podacima: prikupljanje, organizaciju, transformisanje, filtriranje i formatiranje podataka zaključno sa čišćenjem podataka. Obrada podataka prethodi fazi analize podataka za koju je specijalističko znanje neophodno.</p>
<section id="nizovi-i-tabele">
<h2>Nizovi i tabele<a class="headerlink" href="#nizovi-i-tabele" title="Permalink to this headline">¶</a></h2>
<p>Struktura podataka sa kojom najčešće radimo je tabela. Kad otvorimo Eksel, na primer, ispred nas je tabela sa vrstama i kolonama. Kad pogledamo u neku bazu podataka, opet vidimo da su tamo podaci raspoređeni u tabele. Tako je i kod skriptne obrade podataka: najvažnija struktura je tabela.</p>
<p>Pre nego što počnemo da radimo sa tabelama, važno je da razumemo da se dvodimenzionalne strukture (tabele) sastoje od jednodimenzionalnih struktura (nizova) koje smo ukrstili. Svako polje u tabeli pripada jednoj vrsti i jednoj koloni. Tabele se prave od nizova koje slažemo po jednoj ili drugoj dimenziji.</p>
<p>Jednodimenzionalne strukture podataka koje se u Pajtonu najčešće koriste su <strong>liste</strong>. To su najopštiji nizovi podataka gde elementi mogu da budu različitog tipa. Liste se formiraju tako što se između uglastih zagrada navedu svi elementi liste pri čemu ih odvajamo zarezom. Naravno, stringovi (odnosno niske kako ih na srpskom obično zovemo) moraju da budu pod znacima navoda.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lista</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;kafa&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">200.00</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Elementima liste se pristupa preko indeksa elementa. Pošto Pajton elemente numeriše počevši od nultog, prvi element liste ima indeks 0, drugi ima indeks 1 itd.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lista</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;kafa&#39;
</pre></div>
</div>
</div>
</div>
<p>Druga važna jednodimenzionalna struktura je <strong>rečnik</strong> (eng. <em>dictionary</em>). To je zapravo niz parova podataka koji se navode unutar vitičastih zagrada pri čemu su parovi povezani znakom <code class="docutils literal notranslate"><span class="pre">:</span></code>, a odvojeni zarezima. Prvi deo para naziva se ključ, a drugi vrednost.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rečnik</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Piće&#39;</span><span class="p">:</span><span class="s1">&#39;kafa&#39;</span><span class="p">,</span><span class="s1">&#39;Cena&#39;</span><span class="p">:</span><span class="mf">200.00</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Za razliku od lista, kod rečnika nema numeričkih indeksa. Element rečnika pozivamo koristeći ključ.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rečnik</span><span class="p">[</span><span class="s1">&#39;Cena&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>200.0
</pre></div>
</div>
</div>
</div>
<p>Obe pomenute strukture, i liste i rečnici, koriste se za formiranje tabela u Pajtonu.</p>
</section>
<section id="tabela-tipa-dataframe">
<h2>Tabela tipa <em>DataFrame</em><a class="headerlink" href="#tabela-tipa-dataframe" title="Permalink to this headline">¶</a></h2>
<p>Za dvodimenzionalne strukture podataka (tabele) u Pajtonu najčešće koristimo strukturu <em>DataFrame</em>. Osnovno okruženje Pajtona nema funkcije za rad sa ovom strukturom. Neophodno je da učitamo biblioteku <strong>pandas</strong> koja sadrži sve potrebne funkcije za rad sa <em>DataFrame</em> strukturom.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<p>Primetite da smo učitali <strong>pandas</strong> biblioteku i nazvali je <strong>pd</strong>. Ovo smo učinili da bismo kasnije manje kucali pri pozivanju funkcija ove biblioteke. Svaka funkcija iz biblioteke <strong>Pandas</strong> se poziva sa <code class="docutils literal notranslate"><span class="pre">pd.&lt;naziv</span> <span class="pre">funkcije&gt;</span></code>. Videćete kasnije na primerima kako to funkcioniše.</p>
<div class="admonition-napomena admonition">
<p class="admonition-title">Napomena</p>
<p>Strogo govoreći, Pajton razlikuje funkcije i metode. Funkcije možemo da pozivamo samo po imenu i one nisu vezane za objekat (npr. <code class="docutils literal notranslate"><span class="pre">sum()</span></code>) dok metode možemo da pozivamo samo uz ime objekta (npr. <code class="docutils literal notranslate"><span class="pre">df.info()</span></code>). Pošto ova razlika nije posebno važna za teme kojima ćemo se baviti, ubuduće ćemo, jednostavnosti radi, i funkcije i metode zvati funkcijama.</p>
</div>
<p>Sada ćemo jednu jednostavnu tabelu formirati na dva načina: kao niz vrsta i kao niz kolona, tačnije kao listu vrsta i rečnik kolona. Za to će nam biti potrebna i funkcija <code class="docutils literal notranslate"><span class="pre">DataFrame()</span></code>.</p>
<section id="tabela-kao-lista-vrsta">
<h3>Tabela kao lista vrsta<a class="headerlink" href="#tabela-kao-lista-vrsta" title="Permalink to this headline">¶</a></h3>
<p>Svaku vrstu tabele možemo da odredimo kao listu. Važno je samo da sve te vrste imaju isti broj elemenata i da redosled elemenata (prema kategoriji na koju se odnose) bude isti.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v1</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;kafa&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mf">150.0</span><span class="p">]</span>
<span class="n">v2</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;limunada&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">200.0</span><span class="p">]</span>
<span class="n">v3</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tonik&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">180.0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Sada možemo da napravimo listu lista i da je stavimo kao argument funkcije <code class="docutils literal notranslate"><span class="pre">DataFrame()</span></code>. Rezultat će biti nova struktura tipa <em>DataFrame</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vrste</span><span class="o">=</span><span class="p">[</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">,</span><span class="n">v3</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">vrste</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>kafa</td>
      <td>3</td>
      <td>150.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>limunada</td>
      <td>2</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>tonik</td>
      <td>1</td>
      <td>180.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Polja u različitim kolonama ove tabele mogu sadržati različite tipove promenljivih. U našem primeru prva kolona sadrži stringove, druga cele brojeve, a treća decimalne.</p>
<p>Vidimo da Pajton automatski stavlja oznake za kolone i vrste (0, 1, 2…) iako to nismo tražili. Ako nam se ove oznake ne sviđaju, bolje je da navedemo nazive kolona pri kreiranju strukture <strong>df</strong> dodeljujući listu vrednosti parametru <code class="docutils literal notranslate"><span class="pre">columns</span></code>. Slično možemo da uradimo i za nazive vrsta. Tu listu naziva dodeljujemo parametru <code class="docutils literal notranslate"><span class="pre">index</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">vrste</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Piće&#39;</span><span class="p">,</span><span class="s1">&#39;Broj&#39;</span><span class="p">,</span><span class="s1">&#39;Cena&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Piće</th>
      <th>Broj</th>
      <th>Cena</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>kafa</td>
      <td>3</td>
      <td>150.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>limunada</td>
      <td>2</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>tonik</td>
      <td>1</td>
      <td>180.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Naziv kolone u tabeli može da bude bilo koji tekst, ali to nije preporučljivo. Iz praktičnih razloga dobro je da nazivi kolona budu kratki, po mogućstvu da to bude samo jedna reč. Ima funkcija koje čak ne rade kako treba ako naziv kolone nije jedna reč. Zato je nekad dobro preimenovati kolone pre obrade podataka.</p>
</section>
<section id="tabela-kao-recnik-kolona">
<h3>Tabela kao rečnik kolona<a class="headerlink" href="#tabela-kao-recnik-kolona" title="Permalink to this headline">¶</a></h3>
<p>Ako tabelu formiramo kao niz kolona, onda nam je potreban rečnik gde će ključevi biti nazivi kolona, a vrednosti upravo vrednosti kolona. Prvo treba da napravimo liste u kojima će biti vrednosti po kolonama. Sada je važno da liste imaju elemente istog tipa.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k1</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;kafa&#39;</span><span class="p">,</span><span class="s1">&#39;limunada&#39;</span><span class="p">,</span><span class="s1">&#39;tonik&#39;</span><span class="p">]</span>
<span class="n">k2</span><span class="o">=</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">k3</span><span class="o">=</span><span class="p">[</span><span class="mf">150.0</span><span class="p">,</span><span class="mf">200.0</span><span class="p">,</span><span class="mf">180.0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Pošto imamo vrednosti po kolonama možemo da ih pridružimo odgovarajućim ključevima (Piće, Broj, Cena) u okviru rečnika koji ćemo nazvati <strong>kolone</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">kolone</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Piće&#39;</span><span class="p">:</span><span class="n">k1</span><span class="p">,</span><span class="s1">&#39;Broj&#39;</span><span class="p">:</span><span class="n">k2</span><span class="p">,</span><span class="s1">&#39;Cena&#39;</span><span class="p">:</span><span class="n">k3</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Ovaj rečnik sada treba staviti kao argumet funkcije <code class="docutils literal notranslate"><span class="pre">DataFrame()</span></code> da bismo dobili odgovarajuću tabelu.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">kolone</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Piće</th>
      <th>Broj</th>
      <th>Cena</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>kafa</td>
      <td>3</td>
      <td>150.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>limunada</td>
      <td>2</td>
      <td>200.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>tonik</td>
      <td>1</td>
      <td>180.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="pristupanje-elementima-tabele">
<h3>Pristupanje elementima tabele<a class="headerlink" href="#pristupanje-elementima-tabele" title="Permalink to this headline">¶</a></h3>
<p>Ako hoćemo da izdvojimo jednu kolonu, dovoljno je da uz ime tabele stavimo tačku i navedemo njen naziv (pod uslovom da je naziv kolone jedna reč).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">Piće</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0        kafa
1    limunada
2       tonik
Name: Piće, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Alternativno, možemo da navedemo naziv kolone kao indeks u uglastim zagradama.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Piće&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0        kafa
1    limunada
2       tonik
Name: Piće, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Primetite da kolone i redovi uvek imaju svoje oznake, makar bile i brojevi 0, 1, 2… To nam olakšava da pristupimo podacima u tabeli.</p>
<p>Postoji nekoliko načina kako da pristupimo pojedinačnim elementima tabele. Navodimo ovde dva primera koja bi trebalo da budu razumljivi i bez posebnog objašnjenja. Jednostavno, prvo kolonu predstavimo kao listu, a onda uzmemo element liste sa određenim indeksom.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">Piće</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;tonik&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Piće&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;tonik&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="pristupnici-eng-accessors">
<h3>Pristupnici (eng. <em>accessors</em>)<a class="headerlink" href="#pristupnici-eng-accessors" title="Permalink to this headline">¶</a></h3>
<p>Pristupnik <code class="docutils literal notranslate"><span class="pre">iloc[]</span></code> je posebna vrsta funkcije koja nam omogućava da elementima tabele pristupimo na još jedan način. Njeni argumenti su indeksi redova i kolona. Za razliku od funkcija kod kojih argumente stavljamo u obične zagrade, kod pristupnika koristimo uglaste zagrade.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;tonik&#39;
</pre></div>
</div>
</div>
</div>
<p>Postoji još jedan pristupnik: <code class="docutils literal notranslate"><span class="pre">loc[]</span></code>. Njegovi argumenti nisu indeksi već nazivi redova i kolona, ukoliko su određeni. Mi jesmo odredili nazive kolona, ali nazive vrsta nismo pa tu još uvek imamo 0, 1, 2 kao privremene nazive. Dok god se to ne promeni brojevi 0, 1 i 2 će biti i indeksi i nazivi vrsta.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Piće&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;limunada&#39;
</pre></div>
</div>
</div>
</div>
<p>Pošto znamo kako se formiraju tabele i kako se pristupa njihovim elementima, možemo da pređemo na obradu veće tabele koju ćemo učitati iz fajla.</p>
</section>
</section>
<section id="ucitavanje-velike-tabele-sa-podacima">
<h2>Učitavanje velike tabele sa podacima<a class="headerlink" href="#ucitavanje-velike-tabele-sa-podacima" title="Permalink to this headline">¶</a></h2>
<p>Podatke najčešće čuvamo u formatima koji nisu jednostavni za učitavanje. Formati kao što su DOCX, XLSX, PDF ili HTML odgovaraju čoveku koji čita podatke, ali ne i mašini. Za skriptnu obradu podataka su mnogo pogodniji jednostavni, dobro dokumentovani i otvoreni formati za koje ne moramo da koristimo bilo kakav poseban komercijalni softver. Čak i kada se podaci učitavaju iz vrlo složenih formata oni se transformišu u tabele koje se čuvaju u svega nekoliko osnovnih formata. Najčešće se za tabelarne podatke koristi <em>Comma Separated Value</em> (CSV) format gde se vrednosti odvojene zarezom zapisane u tekstualnom formatu.</p>
<p>Za potrebe rada u ovoj svesci koristićemo fajl sa podacima koji se odnose na sva veća postrojenja za proizvodnju električne energije u svetu. Njih možete sami da preuzmete sa interneta sa <a class="reference external" href="https://datasets.wri.org/dataset/globalpowerplantdatabase">Global Power Plant Database</a>, ali smo ih zbog jednostavnosti postavili u poddirekterijum <strong>/data</strong> našeg radnog direktorijuma. Tu se nalaze i svi ostali fajlovi sa podacima koji će nam biti potrebni u ovom kursu. Za početak, učitavamo fajl koji sadrži spisak svih velikih elektrana u svetu.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elektrane</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/global_power_plant_database.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\srdjan\anaconda3\lib\site-packages\IPython\core\interactiveshell.py:3444: DtypeWarning: Columns (10) have mixed types.Specify dtype option on import or set low_memory=False.
  exec(code_obj, self.user_global_ns, self.user_ns)
</pre></div>
</div>
</div>
</div>
<p>Pošto je fajl prilično veliki, verovatno ćete dobiti upozorenje da u tabeli imamo različite tipove podataka i ovakvo učitavanje fajla bez specifikacije koji tip podataka imamo u kojoj koloni nije efikasan. S obzirom da ćemo ovaj fajl učitavati samo jednom, najbolje je da ignorišete ovo upozorenje. Ako baš ne možete, objasnite računaru da ne mora da se plaši da će ostati bez slobodne memorije i učitajte podatke sa <code class="docutils literal notranslate"><span class="pre">elektrane=pd.read_csv(&quot;data/global_power_plant_database.csv&quot;,</span> <span class="pre">low_memory=False)</span></code>. U tom slučaju neće prikazivati upozorenje.</p>
<p>U svakom slučaju, poželjno je da pomoću funkcije <code class="docutils literal notranslate"><span class="pre">info()</span></code> pogledamo šta se nalazi u fajlu, koje su to kolone i koji je tip podataka u njim sadržan.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elektrane</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 34936 entries, 0 to 34935
Data columns (total 36 columns):
 #   Column                          Non-Null Count  Dtype  
---  ------                          --------------  -----  
 0   country                         34936 non-null  object 
 1   country_long                    34936 non-null  object 
 2   name                            34936 non-null  object 
 3   gppd_idnr                       34936 non-null  object 
 4   capacity_mw                     34936 non-null  float64
 5   latitude                        34936 non-null  float64
 6   longitude                       34936 non-null  float64
 7   primary_fuel                    34936 non-null  object 
 8   other_fuel1                     1944 non-null   object 
 9   other_fuel2                     276 non-null    object 
 10  other_fuel3                     92 non-null     object 
 11  commissioning_year              17447 non-null  float64
 12  owner                           20868 non-null  object 
 13  source                          34921 non-null  object 
 14  url                             34918 non-null  object 
 15  geolocation_source              34517 non-null  object 
 16  wepp_id                         16234 non-null  object 
 17  year_of_capacity_data           14887 non-null  float64
 18  generation_gwh_2013             6417 non-null   float64
 19  generation_gwh_2014             7226 non-null   float64
 20  generation_gwh_2015             8203 non-null   float64
 21  generation_gwh_2016             9144 non-null   float64
 22  generation_gwh_2017             9500 non-null   float64
 23  generation_gwh_2018             9637 non-null   float64
 24  generation_gwh_2019             9659 non-null   float64
 25  generation_data_source          11400 non-null  object 
 26  estimated_generation_gwh_2013   16120 non-null  float64
 27  estimated_generation_gwh_2014   16503 non-null  float64
 28  estimated_generation_gwh_2015   17050 non-null  float64
 29  estimated_generation_gwh_2016   17570 non-null  float64
 30  estimated_generation_gwh_2017   33138 non-null  float64
 31  estimated_generation_note_2013  34936 non-null  object 
 32  estimated_generation_note_2014  34936 non-null  object 
 33  estimated_generation_note_2015  34936 non-null  object 
 34  estimated_generation_note_2016  34936 non-null  object 
 35  estimated_generation_note_2017  34936 non-null  object 
dtypes: float64(17), object(19)
memory usage: 9.6+ MB
</pre></div>
</div>
</div>
</div>
<p>Odavde vidimo, na primer, da <em>DataFrame</em> <strong>elektrane</strong> ima 34936 redova i 36 kolona. Za svaku kolonu navedeno je kakve podatke sadrži i koliko takvih podataka ima. Iako sve kolone sadrže isti broj elemenata, moguće je da su neki od njih <strong>null</strong>, odnosno da ti podaci nedostaju. Zato za svaku kolonu imamo broj elemenata koji nisu <strong>null</strong>, odnosno onih podataka koji su ubeleženi.</p>
<p>Pajton često koristi opštije tipove podataka da se pri učitavanju ne bi nešto izgubilo. Tako su celobrojne vrednosti memorisane kao 64-bitni decimalni brojevi (<em>float64</em>), a tekst kao objekat (<em>object</em>). To nije najbolje sa aspekta korišćenja memorije, ali sada ne moramo time da se bavimo. Ako zatreba, moći ćete kasnije da promenite tip promenljive u koloni.</p>
<p>Drugi način da vidimo šta se nalazi u tabeli je da pomoću funkcije <code class="docutils literal notranslate"><span class="pre">head()</span></code> pogledamo zaglavlje, tj. nazive kolona sa prvih nekoliko redova. Slično, možemo da pogledamo i začelje tabele pomoću funkcije <code class="docutils literal notranslate"><span class="pre">tail()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elektrane</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>country_long</th>
      <th>name</th>
      <th>gppd_idnr</th>
      <th>capacity_mw</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>primary_fuel</th>
      <th>other_fuel1</th>
      <th>other_fuel2</th>
      <th>...</th>
      <th>estimated_generation_gwh_2013</th>
      <th>estimated_generation_gwh_2014</th>
      <th>estimated_generation_gwh_2015</th>
      <th>estimated_generation_gwh_2016</th>
      <th>estimated_generation_gwh_2017</th>
      <th>estimated_generation_note_2013</th>
      <th>estimated_generation_note_2014</th>
      <th>estimated_generation_note_2015</th>
      <th>estimated_generation_note_2016</th>
      <th>estimated_generation_note_2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AFG</td>
      <td>Afghanistan</td>
      <td>Kajaki Hydroelectric Power Plant Afghanistan</td>
      <td>GEODB0040538</td>
      <td>33.0</td>
      <td>32.322</td>
      <td>65.1190</td>
      <td>Hydro</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>123.77</td>
      <td>162.90</td>
      <td>97.39</td>
      <td>137.76</td>
      <td>119.50</td>
      <td>HYDRO-V1</td>
      <td>HYDRO-V1</td>
      <td>HYDRO-V1</td>
      <td>HYDRO-V1</td>
      <td>HYDRO-V1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AFG</td>
      <td>Afghanistan</td>
      <td>Kandahar DOG</td>
      <td>WKS0070144</td>
      <td>10.0</td>
      <td>31.670</td>
      <td>65.7950</td>
      <td>Solar</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>18.43</td>
      <td>17.48</td>
      <td>18.25</td>
      <td>17.70</td>
      <td>18.29</td>
      <td>SOLAR-V1-NO-AGE</td>
      <td>SOLAR-V1-NO-AGE</td>
      <td>SOLAR-V1-NO-AGE</td>
      <td>SOLAR-V1-NO-AGE</td>
      <td>SOLAR-V1-NO-AGE</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AFG</td>
      <td>Afghanistan</td>
      <td>Kandahar JOL</td>
      <td>WKS0071196</td>
      <td>10.0</td>
      <td>31.623</td>
      <td>65.7920</td>
      <td>Solar</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>18.64</td>
      <td>17.58</td>
      <td>19.10</td>
      <td>17.62</td>
      <td>18.72</td>
      <td>SOLAR-V1-NO-AGE</td>
      <td>SOLAR-V1-NO-AGE</td>
      <td>SOLAR-V1-NO-AGE</td>
      <td>SOLAR-V1-NO-AGE</td>
      <td>SOLAR-V1-NO-AGE</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AFG</td>
      <td>Afghanistan</td>
      <td>Mahipar Hydroelectric Power Plant Afghanistan</td>
      <td>GEODB0040541</td>
      <td>66.0</td>
      <td>34.556</td>
      <td>69.4787</td>
      <td>Hydro</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>225.06</td>
      <td>203.55</td>
      <td>146.90</td>
      <td>230.18</td>
      <td>174.91</td>
      <td>HYDRO-V1</td>
      <td>HYDRO-V1</td>
      <td>HYDRO-V1</td>
      <td>HYDRO-V1</td>
      <td>HYDRO-V1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AFG</td>
      <td>Afghanistan</td>
      <td>Naghlu Dam Hydroelectric Power Plant Afghanistan</td>
      <td>GEODB0040534</td>
      <td>100.0</td>
      <td>34.641</td>
      <td>69.7170</td>
      <td>Hydro</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>406.16</td>
      <td>357.22</td>
      <td>270.99</td>
      <td>395.38</td>
      <td>350.80</td>
      <td>HYDRO-V1</td>
      <td>HYDRO-V1</td>
      <td>HYDRO-V1</td>
      <td>HYDRO-V1</td>
      <td>HYDRO-V1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 36 columns</p>
</div></div></div>
</div>
</section>
<section id="izbor-kolona">
<h2>Izbor kolona<a class="headerlink" href="#izbor-kolona" title="Permalink to this headline">¶</a></h2>
<p>Za rad sa tabelama nije neophodno da imamo baš sve kolone u memoriji. Ako izaberemo samo ono što nas interesuje, tabela će biti preglednija.</p>
<p>Za potrebe ove demonstracije uzećemo samo prvih osam kolona, zaključno sa kolonom u kojoj je primarni tip goriva. Za to ćemo koristiti indekse redova i kolona pomoću <code class="docutils literal notranslate"><span class="pre">iloc[:,0:8]</span></code>. Ovo prvo <code class="docutils literal notranslate"><span class="pre">:</span></code> znači da uzimamo sve redove, a <code class="docutils literal notranslate"><span class="pre">0:8</span></code> da uzimamo 8 kolona počevši od indeksa 0 (prva kolona). Imajte u vidu da se prva kolona (za nas ljude koji gledamo ispis na ekranu) i ne računa u kolone. To su samo oznake redova. Za Pajton, prva kolona je <strong>country</strong> i ona ima indeks 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elektrane</span><span class="o">=</span><span class="n">elektrane</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elektrane</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>country_long</th>
      <th>name</th>
      <th>gppd_idnr</th>
      <th>capacity_mw</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>primary_fuel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AFG</td>
      <td>Afghanistan</td>
      <td>Kajaki Hydroelectric Power Plant Afghanistan</td>
      <td>GEODB0040538</td>
      <td>33.0</td>
      <td>32.322</td>
      <td>65.1190</td>
      <td>Hydro</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AFG</td>
      <td>Afghanistan</td>
      <td>Kandahar DOG</td>
      <td>WKS0070144</td>
      <td>10.0</td>
      <td>31.670</td>
      <td>65.7950</td>
      <td>Solar</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AFG</td>
      <td>Afghanistan</td>
      <td>Kandahar JOL</td>
      <td>WKS0071196</td>
      <td>10.0</td>
      <td>31.623</td>
      <td>65.7920</td>
      <td>Solar</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AFG</td>
      <td>Afghanistan</td>
      <td>Mahipar Hydroelectric Power Plant Afghanistan</td>
      <td>GEODB0040541</td>
      <td>66.0</td>
      <td>34.556</td>
      <td>69.4787</td>
      <td>Hydro</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AFG</td>
      <td>Afghanistan</td>
      <td>Naghlu Dam Hydroelectric Power Plant Afghanistan</td>
      <td>GEODB0040534</td>
      <td>100.0</td>
      <td>34.641</td>
      <td>69.7170</td>
      <td>Hydro</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Na ovaj način smo izabrali koje kolone želimo da koristimo i sačuvali samo to u tabeli <strong>elektrane</strong>. Slično smo mogli da umesto 0:8 stavimo listu gde tačno navedemo koje kolone hoćemo, npr. <code class="docutils literal notranslate"><span class="pre">[0,4,7]</span></code>. Probajte.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elektrane</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>capacity_mw</th>
      <th>primary_fuel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AFG</td>
      <td>33.0</td>
      <td>Hydro</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AFG</td>
      <td>10.0</td>
      <td>Solar</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AFG</td>
      <td>10.0</td>
      <td>Solar</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AFG</td>
      <td>66.0</td>
      <td>Hydro</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AFG</td>
      <td>100.0</td>
      <td>Hydro</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>34931</th>
      <td>ZMB</td>
      <td>50.0</td>
      <td>Oil</td>
    </tr>
    <tr>
      <th>34932</th>
      <td>ZMB</td>
      <td>20.0</td>
      <td>Oil</td>
    </tr>
    <tr>
      <th>34933</th>
      <td>ZMB</td>
      <td>108.0</td>
      <td>Hydro</td>
    </tr>
    <tr>
      <th>34934</th>
      <td>ZWE</td>
      <td>920.0</td>
      <td>Coal</td>
    </tr>
    <tr>
      <th>34935</th>
      <td>ZWE</td>
      <td>750.0</td>
      <td>Hydro</td>
    </tr>
  </tbody>
</table>
<p>34936 rows × 3 columns</p>
</div></div></div>
</div>
</section>
<section id="tabulacija">
<h2>Tabulacija<a class="headerlink" href="#tabulacija" title="Permalink to this headline">¶</a></h2>
<p>Jedan od prvih koraka u “eksplorativnoj analizi podataka”, odnosno utvrđivanju šta sve imamo u tabeli jeste da prebrojimo koliko čega ima. Ono što se stručno zove tabulacija, kros-tabulacija ili <em>contingency table</em> je zapravo obično prebrojavanje elemenata po kategorijama. Za početak, uzećemo kolonu sa oznakama zemalja u kojima se nalaze elektrane u prebrojati ih pomoću funkcije <code class="docutils literal notranslate"><span class="pre">value_counts()</span></code>. To će nam reći koliko ima elektrana u kojoj zemlji. Pri tome će funkcija koja prebrojava elemente sortirati niz od najvećeg ka najmanjem pa će na prvom mestu biti zemlja sa najvećim brojem elektrana u ovoj tabeli.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elektrane</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>country
USA    9833
CHN    4235
GBR    2751
BRA    2360
FRA    2155
       ... 
PSE       1
DJI       1
SUR       1
ESH       1
GNB       1
Length: 167, dtype: int64
</pre></div>
</div>
</div>
</div>
<section id="kros-tabulacija">
<h3>Kros-tabulacija<a class="headerlink" href="#kros-tabulacija" title="Permalink to this headline">¶</a></h3>
<p>Kros-tabulacija je prebrojavanje elemenata po dve odvojene kategorije. Ovde ćemo, na primer, prebrojati koliko se puta pominje koja zemlja za svaki tip primarnih goriva. Tako ćemo videti ko ima koliko elektrana na vetar, koliko nuklearnih elektrana itd. Da bismo to uradili nije dovoljna funkcija <code class="docutils literal notranslate"><span class="pre">value_counts()</span></code> već moramo da razdvojimo kolone koje ćemo tretirati kao posebne kategorijalne promenljive. Funkcija <code class="docutils literal notranslate"><span class="pre">crosstab()</span></code> zahteva dva argumenta tog tipa. To su upravo dve kolone naše tabele.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zemljа</span><span class="o">=</span><span class="n">elektrane</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span>
<span class="n">gorivo</span><span class="o">=</span><span class="n">elektrane</span><span class="p">[</span><span class="s1">&#39;primary_fuel&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zemljа</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0        AFG
1        AFG
2        AFG
3        AFG
4        AFG
        ... 
34931    ZMB
34932    ZMB
34933    ZMB
34934    ZWE
34935    ZWE
Name: country, Length: 34936, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">zemljа</span><span class="p">,</span><span class="n">gorivo</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>primary_fuel</th>
      <th>Biomass</th>
      <th>Coal</th>
      <th>Cogeneration</th>
      <th>Gas</th>
      <th>Geothermal</th>
      <th>Hydro</th>
      <th>Nuclear</th>
      <th>Oil</th>
      <th>Other</th>
      <th>Petcoke</th>
      <th>Solar</th>
      <th>Storage</th>
      <th>Waste</th>
      <th>Wave and Tidal</th>
      <th>Wind</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AFG</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>AGO</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ALB</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ARE</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>24</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ARG</th>
      <td>0</td>
      <td>9</td>
      <td>0</td>
      <td>57</td>
      <td>0</td>
      <td>50</td>
      <td>3</td>
      <td>96</td>
      <td>2</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>VNM</th>
      <td>2</td>
      <td>24</td>
      <td>0</td>
      <td>9</td>
      <td>0</td>
      <td>174</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>16</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>YEM</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ZAF</th>
      <td>2</td>
      <td>17</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>6</td>
      <td>1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>44</td>
      <td>0</td>
      <td>6</td>
      <td>0</td>
      <td>24</td>
    </tr>
    <tr>
      <th>ZMB</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
      <td>0</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>ZWE</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>167 rows × 15 columns</p>
</div></div></div>
</div>
<p>Izgleda da ovih tipova goriva ima više nego što smo očekivali (15). Svejedno, odavde možemo da vidimo ko ima koliko elektrana kog tipa. Kako se koji tip goriva zove mogli smo da dobijemo sa <code class="docutils literal notranslate"><span class="pre">elektrane.value_counts('primary_fuel')</span></code>. Alternativno, možemo da iskoristimo funkciju <code class="docutils literal notranslate"><span class="pre">columns</span></code> koja će nam iste podatke dati za kategorijalnu tabelu.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">crosstab</span><span class="p">(</span><span class="n">zemljа</span><span class="p">,</span><span class="n">gorivo</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Biomass&#39;, &#39;Coal&#39;, &#39;Cogeneration&#39;, &#39;Gas&#39;, &#39;Geothermal&#39;, &#39;Hydro&#39;,
       &#39;Nuclear&#39;, &#39;Oil&#39;, &#39;Other&#39;, &#39;Petcoke&#39;, &#39;Solar&#39;, &#39;Storage&#39;, &#39;Waste&#39;,
       &#39;Wave and Tidal&#39;, &#39;Wind&#39;],
      dtype=&#39;object&#39;, name=&#39;primary_fuel&#39;)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="sortiranje">
<h2>Sortiranje<a class="headerlink" href="#sortiranje" title="Permalink to this headline">¶</a></h2>
<p>Menjajući redosled redova i kolona u tabeli možemo da uredimo tabelu kako nama odgovara, a da pritom ništa ne izgubimo od podataka. Najčešće se redosled menja tako što sortiramo podatke po azbučnom/abecednom redu ako su tekstualni ili po veličini ako su numerički. Svako sortiranje može da se vrši i hijerarhijski. Setite se fudbalskih tabela: klubovi su sortirani po broju bodova, ali ako imaju isti broj bodova onda ih sortiramo po gol-razlici. Tu onda imamo dva kriterijuma sortiranja. Važan je i smer sortiranja. Numerički podaci, na primer, mogu da se sortiraju po rastućem ili opadajućem redosledu.</p>
<p>Mi ćemo sada podatke o svetskim elektranama da sortiramo po snazi izraženoj u megavatima (kolona <strong>capacity_mw</strong>) počevši od elektrane koja ima najveću snagu (tj. po redu koji nije rastući – <strong>ascending=False</strong>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elektrane</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;capacity_mw&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>country_long</th>
      <th>name</th>
      <th>gppd_idnr</th>
      <th>capacity_mw</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>primary_fuel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>8453</th>
      <td>CHN</td>
      <td>China</td>
      <td>Three Gorges Dam</td>
      <td>WRI1000452</td>
      <td>22500.0</td>
      <td>30.8235</td>
      <td>111.0032</td>
      <td>Hydro</td>
    </tr>
    <tr>
      <th>5137</th>
      <td>CHN</td>
      <td>China</td>
      <td>Baihetan Dam</td>
      <td>WRI1070877</td>
      <td>13050.0</td>
      <td>28.2606</td>
      <td>103.6484</td>
      <td>Hydro</td>
    </tr>
    <tr>
      <th>8755</th>
      <td>CHN</td>
      <td>China</td>
      <td>Xiluodu</td>
      <td>WRI1000453</td>
      <td>12600.0</td>
      <td>28.2600</td>
      <td>103.6500</td>
      <td>Hydro</td>
    </tr>
    <tr>
      <th>19603</th>
      <td>RUS</td>
      <td>Russia</td>
      <td>Surgutskaya GRES-2</td>
      <td>WRI1003821</td>
      <td>8865.0</td>
      <td>61.2794</td>
      <td>73.4889</td>
      <td>Gas</td>
    </tr>
    <tr>
      <th>34668</th>
      <td>VEN</td>
      <td>Venezuela</td>
      <td>Simon Bolivar (Guri)</td>
      <td>WRI1018677</td>
      <td>8851.0</td>
      <td>7.7659</td>
      <td>-62.9982</td>
      <td>Hydro</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>33625</th>
      <td>USA</td>
      <td>United States of America</td>
      <td>USS Solar Dawn CSG</td>
      <td>USA0062044</td>
      <td>1.0</td>
      <td>45.4918</td>
      <td>-92.8417</td>
      <td>Solar</td>
    </tr>
    <tr>
      <th>15796</th>
      <td>IDN</td>
      <td>Indonesia</td>
      <td>Sempor/Mrica</td>
      <td>WRI1001009</td>
      <td>1.0</td>
      <td>-7.4733</td>
      <td>109.3331</td>
      <td>Hydro</td>
    </tr>
    <tr>
      <th>33624</th>
      <td>USA</td>
      <td>United States of America</td>
      <td>USS Rockpoint Solar CSG</td>
      <td>USA0062000</td>
      <td>1.0</td>
      <td>45.4396</td>
      <td>-92.9221</td>
      <td>Solar</td>
    </tr>
    <tr>
      <th>23239</th>
      <td>GBR</td>
      <td>United Kingdom</td>
      <td>Innerwick Hydro</td>
      <td>GBR0000472</td>
      <td>1.0</td>
      <td>56.6003</td>
      <td>-4.3052</td>
      <td>Hydro</td>
    </tr>
    <tr>
      <th>33111</th>
      <td>USA</td>
      <td>United States of America</td>
      <td>SunEdison Anheuser Busch Fairfield</td>
      <td>USA0057010</td>
      <td>1.0</td>
      <td>38.2321</td>
      <td>-122.0927</td>
      <td>Solar</td>
    </tr>
  </tbody>
</table>
<p>34936 rows × 8 columns</p>
</div></div></div>
</div>
<p>Tabela nam pokazuje da hidroelektrana “Tri klisure” u Kini ima najveći kapacitet: 22,5 gigavata. Neki od nas su u školi učili da Huverova elektrana na reci Kolorado proizvodi najviše struje. Davno je to bilo. Izgleda da se nešto promenilo. Da bismo utvrdili koja je po redu Huverova elektrana danas potrebno je da elektranama pridružimo poziciju na rang-listi. Najbolje je da celoj tabeli dodamo kolonu u kojoj će biti rang elektrane od najveće do najmanje. Tu kolonu ćemo nazvati <strong>rank</strong>. (I ostali nazivi kolona su nam na engleskom, zar ne?)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elektrane</span><span class="p">[</span><span class="s1">&#39;rank&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">elektrane</span><span class="p">[</span><span class="s1">&#39;capacity_mw&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">rank</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Primetite da smo u prethodnom slučaju samo prikazali sortiranu tabelu, a da smo potom originalnoj tabeli <strong>elektrane</strong> pridružili kolonu sa rang-listom. To je samo drugi način sortiranja. Da vidimo kako sad izgleda zaglavlje tabele. Prva u tabeli je avganistanska elektrana koja je 13036. na rang-listi. Vidimo da negde ima i necelobrojnih vrednosti za rang. To je zato što ih ima više sa istom snagom.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elektrane</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>country_long</th>
      <th>name</th>
      <th>gppd_idnr</th>
      <th>capacity_mw</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>primary_fuel</th>
      <th>rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AFG</td>
      <td>Afghanistan</td>
      <td>Kajaki Hydroelectric Power Plant Afghanistan</td>
      <td>GEODB0040538</td>
      <td>33.0</td>
      <td>32.322</td>
      <td>65.1190</td>
      <td>Hydro</td>
      <td>13036.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AFG</td>
      <td>Afghanistan</td>
      <td>Kandahar DOG</td>
      <td>WKS0070144</td>
      <td>10.0</td>
      <td>31.670</td>
      <td>65.7950</td>
      <td>Solar</td>
      <td>20851.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>AFG</td>
      <td>Afghanistan</td>
      <td>Kandahar JOL</td>
      <td>WKS0071196</td>
      <td>10.0</td>
      <td>31.623</td>
      <td>65.7920</td>
      <td>Solar</td>
      <td>20851.5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AFG</td>
      <td>Afghanistan</td>
      <td>Mahipar Hydroelectric Power Plant Afghanistan</td>
      <td>GEODB0040541</td>
      <td>66.0</td>
      <td>34.556</td>
      <td>69.4787</td>
      <td>Hydro</td>
      <td>9260.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>AFG</td>
      <td>Afghanistan</td>
      <td>Naghlu Dam Hydroelectric Power Plant Afghanistan</td>
      <td>GEODB0040534</td>
      <td>100.0</td>
      <td>34.641</td>
      <td>69.7170</td>
      <td>Hydro</td>
      <td>7690.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Da bismo sada u nazivu našli “Hoover”, “Djerdap” ili “Gorges” moramo da promenimo tip podataka u koloni <strong>name</strong> tako da bude tekst, odnosno string. Za Pajton je to i dalje kolona u kojoj su podaci tipa object. To ćemo uraditi pomoću funkcije <code class="docutils literal notranslate"><span class="pre">astype()</span></code> i argumenta <strong>“str”</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elektrane</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">elektrane</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Sada kad u koloni <strong>name</strong> imamo podatke tipa <strong>str</strong> možemo da pitamo gde se na rang-listi nalaze elektrane koje nas interesuju. To ćemo uraditi pomoću funkcije <code class="docutils literal notranslate"><span class="pre">str.contains()</span></code> koja proverava da li se neki tekst nalazi u nekoj tekstualnoj promenljivoj.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elektrane</span><span class="p">[</span><span class="n">elektrane</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Hoover&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>country_long</th>
      <th>name</th>
      <th>gppd_idnr</th>
      <th>capacity_mw</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>primary_fuel</th>
      <th>rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>28706</th>
      <td>USA</td>
      <td>United States of America</td>
      <td>Hoover Dam (AZ)</td>
      <td>USA0008902</td>
      <td>1039.4</td>
      <td>36.0155</td>
      <td>-114.738</td>
      <td>Hydro</td>
      <td>1525.5</td>
    </tr>
    <tr>
      <th>28707</th>
      <td>USA</td>
      <td>United States of America</td>
      <td>Hoover Dam (NV)</td>
      <td>USA0000154</td>
      <td>1039.4</td>
      <td>36.0155</td>
      <td>-114.738</td>
      <td>Hydro</td>
      <td>1525.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Izgleda da se Huverova elektrana vodi dva puta u listi. Jednom kao Huverova brana (Arizona), a drugi put kao Huverova brana (Nevada). Iskreno, ne znamo da li je ukupna snaga 1039,4 MW  ili dva puta po 1039,4 MW. U svakom slučaju, nije baš najbolje plasirana danas.</p>
<p>Da vidimo gde je naš Đerdap.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elektrane</span><span class="p">[</span><span class="n">elektrane</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Djerdap&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>country_long</th>
      <th>name</th>
      <th>gppd_idnr</th>
      <th>capacity_mw</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>primary_fuel</th>
      <th>rank</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<p>Izgleda da ga nema na listi. Barem ne pod ovim imenom. Moraćemo da pokušamo drugačije.</p>
</section>
<section id="filtriranje-redova-i-selekcija-kolona">
<h2>Filtriranje redova i selekcija kolona<a class="headerlink" href="#filtriranje-redova-i-selekcija-kolona" title="Permalink to this headline">¶</a></h2>
<p>Mi možemo da filtriramo podatke i pogledamo samo ono što nas interesuje. 34936 redova je svakako previše za pregledanje red po red. Izabraćemo sada samo onaj deo tabele u kom je Srbija zemlja u kojoj se nalazi elektrana. U uglaste zagrade iza imena tabele ćemo staviti logički iskaz <code class="docutils literal notranslate"><span class="pre">elektrane['country']=='SRB'</span></code>. Onda će nam od tabele ostati samo oni redovi u kojima je taj iskaz tačan, odnosno gde je zemlja Srbija.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elektrane</span><span class="p">[</span><span class="n">elektrane</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;SRB&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>country_long</th>
      <th>name</th>
      <th>gppd_idnr</th>
      <th>capacity_mw</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>primary_fuel</th>
      <th>rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>19832</th>
      <td>SRB</td>
      <td>Serbia</td>
      <td>HE BAJINA BASTA</td>
      <td>WRI1020282</td>
      <td>420.0</td>
      <td>43.9645</td>
      <td>19.4102</td>
      <td>Hydro</td>
      <td>3555.0</td>
    </tr>
    <tr>
      <th>19833</th>
      <td>SRB</td>
      <td>Serbia</td>
      <td>HE DJERDAP I</td>
      <td>WRI1020277</td>
      <td>1086.0</td>
      <td>44.6684</td>
      <td>22.5268</td>
      <td>Hydro</td>
      <td>1452.0</td>
    </tr>
    <tr>
      <th>19834</th>
      <td>SRB</td>
      <td>Serbia</td>
      <td>HE DJERDAP II</td>
      <td>WRI1020284</td>
      <td>270.0</td>
      <td>44.3065</td>
      <td>22.5667</td>
      <td>Hydro</td>
      <td>4577.5</td>
    </tr>
    <tr>
      <th>19835</th>
      <td>SRB</td>
      <td>Serbia</td>
      <td>RHE BAJINA BASTA</td>
      <td>WRI1020281</td>
      <td>614.0</td>
      <td>43.9645</td>
      <td>19.4102</td>
      <td>Hydro</td>
      <td>2681.0</td>
    </tr>
    <tr>
      <th>19836</th>
      <td>SRB</td>
      <td>Serbia</td>
      <td>TE KOLUBARA</td>
      <td>WRI1020285</td>
      <td>245.0</td>
      <td>44.4806</td>
      <td>20.2934</td>
      <td>Coal</td>
      <td>4825.0</td>
    </tr>
    <tr>
      <th>19837</th>
      <td>SRB</td>
      <td>Serbia</td>
      <td>TE KOSOVO A</td>
      <td>WRI1020280</td>
      <td>617.0</td>
      <td>42.6773</td>
      <td>21.0886</td>
      <td>Coal</td>
      <td>2674.0</td>
    </tr>
    <tr>
      <th>19838</th>
      <td>SRB</td>
      <td>Serbia</td>
      <td>TE KOSOVO B</td>
      <td>WRI1020279</td>
      <td>618.0</td>
      <td>42.6945</td>
      <td>21.0590</td>
      <td>Coal</td>
      <td>2670.5</td>
    </tr>
    <tr>
      <th>19839</th>
      <td>SRB</td>
      <td>Serbia</td>
      <td>TE KOSTOLAC A</td>
      <td>WRI1020283</td>
      <td>281.0</td>
      <td>44.7229</td>
      <td>21.1717</td>
      <td>Coal</td>
      <td>4477.5</td>
    </tr>
    <tr>
      <th>19840</th>
      <td>SRB</td>
      <td>Serbia</td>
      <td>TE KOSTOLAC B</td>
      <td>WRI1020278</td>
      <td>697.0</td>
      <td>44.7307</td>
      <td>21.2104</td>
      <td>Coal</td>
      <td>2348.0</td>
    </tr>
    <tr>
      <th>19841</th>
      <td>SRB</td>
      <td>Serbia</td>
      <td>TE MORAVA</td>
      <td>WRI1020288</td>
      <td>110.0</td>
      <td>44.2248</td>
      <td>21.1627</td>
      <td>Coal</td>
      <td>7202.0</td>
    </tr>
    <tr>
      <th>19842</th>
      <td>SRB</td>
      <td>Serbia</td>
      <td>TENT A</td>
      <td>WRI1020275</td>
      <td>1730.0</td>
      <td>44.6711</td>
      <td>20.1593</td>
      <td>Coal</td>
      <td>653.5</td>
    </tr>
    <tr>
      <th>19843</th>
      <td>SRB</td>
      <td>Serbia</td>
      <td>TENT B</td>
      <td>WRI1020276</td>
      <td>1270.0</td>
      <td>44.6551</td>
      <td>20.0053</td>
      <td>Coal</td>
      <td>1082.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Sad je jasno zašto malopre nismo našli Đerdap. Trebalo je da ga napišemo velikim slovima. Ili, što bi bilo još bolje kažemo da <code class="docutils literal notranslate"><span class="pre">str.contains()</span></code> ne bude osetljiv na to da li su slova mala ili velika. Svejedno, sad imamo podatak da je Đerdap 1 1452. najveća elektrana na svetu. Termoelektrane u Obrenovcu su nam nešto bolje plasirane. Možda time ne bi trebalo da se hvalimo, ali možemo da konstatujemo.</p>
<section id="slozeni-kriterijumi">
<h3>Složeni kriterijumi<a class="headerlink" href="#slozeni-kriterijumi" title="Permalink to this headline">¶</a></h3>
<p>Logički iskaz pomoću kog filtriramo podatke u tabeli može da bude složeniji. Evo primera kako koristimo dva uslova: da je elektrana u Srbiji i da je tipa “Hydro”. Da bi rezultat logičkog iskaza bio izračunat kako treba oba pojedinačna iskaza stavite u zagrade i razdvojte znakom <code class="docutils literal notranslate"><span class="pre">&amp;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elektrane</span><span class="p">[(</span><span class="n">elektrane</span><span class="p">[</span><span class="s1">&#39;country&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;SRB&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">elektrane</span><span class="p">[</span><span class="s1">&#39;primary_fuel&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Hydro&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>country_long</th>
      <th>name</th>
      <th>gppd_idnr</th>
      <th>capacity_mw</th>
      <th>latitude</th>
      <th>longitude</th>
      <th>primary_fuel</th>
      <th>rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>19832</th>
      <td>SRB</td>
      <td>Serbia</td>
      <td>HE BAJINA BASTA</td>
      <td>WRI1020282</td>
      <td>420.0</td>
      <td>43.9645</td>
      <td>19.4102</td>
      <td>Hydro</td>
      <td>3555.0</td>
    </tr>
    <tr>
      <th>19833</th>
      <td>SRB</td>
      <td>Serbia</td>
      <td>HE DJERDAP I</td>
      <td>WRI1020277</td>
      <td>1086.0</td>
      <td>44.6684</td>
      <td>22.5268</td>
      <td>Hydro</td>
      <td>1452.0</td>
    </tr>
    <tr>
      <th>19834</th>
      <td>SRB</td>
      <td>Serbia</td>
      <td>HE DJERDAP II</td>
      <td>WRI1020284</td>
      <td>270.0</td>
      <td>44.3065</td>
      <td>22.5667</td>
      <td>Hydro</td>
      <td>4577.5</td>
    </tr>
    <tr>
      <th>19835</th>
      <td>SRB</td>
      <td>Serbia</td>
      <td>RHE BAJINA BASTA</td>
      <td>WRI1020281</td>
      <td>614.0</td>
      <td>43.9645</td>
      <td>19.4102</td>
      <td>Hydro</td>
      <td>2681.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="agregacija-podataka">
<h2>Agregacija podataka<a class="headerlink" href="#agregacija-podataka" title="Permalink to this headline">¶</a></h2>
<p>Za neke analize je zgodno grupisati podatke. U primeru sa elektranama možemo, na primer, da uradimo pregled po zemljama – da vidimo koliko ima ukupno elektrana i koliko imaju ukupno snage. Prvi korak je da pomoću funkcije <code class="docutils literal notranslate"><span class="pre">groupby()</span></code> grupišemo podatke u tabeli u odnosu da konkretnu kategoriju, tj. podatke u konkretnoj koloni.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">po_zemljama</span><span class="o">=</span><span class="n">elektrane</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;country&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Struktura <strong>po_zemljama</strong> je objekat složeniji od tabele i nije pogodan za prikaz. Bolje je da napravimo <em>DataFrame</em> sa konkretnim statistikama koje nas interesuju. Počećemo od kolone u kojoj za sve zemlje saberemo vrednosti iz kolone <strong>capacity_mw</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">po_zemljama</span><span class="p">[</span><span class="s1">&#39;capacity_mw&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>capacity_mw</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AFG</th>
      <td>300.550</td>
    </tr>
    <tr>
      <th>AGO</th>
      <td>1071.180</td>
    </tr>
    <tr>
      <th>ALB</th>
      <td>1529.000</td>
    </tr>
    <tr>
      <th>ARE</th>
      <td>30327.000</td>
    </tr>
    <tr>
      <th>ARG</th>
      <td>32913.079</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>VNM</th>
      <td>41350.490</td>
    </tr>
    <tr>
      <th>YEM</th>
      <td>1045.000</td>
    </tr>
    <tr>
      <th>ZAF</th>
      <td>50422.700</td>
    </tr>
    <tr>
      <th>ZMB</th>
      <td>2689.337</td>
    </tr>
    <tr>
      <th>ZWE</th>
      <td>1670.000</td>
    </tr>
  </tbody>
</table>
<p>167 rows × 1 columns</p>
</div></div></div>
</div>
<p>Tabeli <strong>gdf</strong> ćemo pridružiti još jednu kolonu: ukupan broj elektrana. Ovu kolonu ćemo nazvati <strong>count</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">po_zemljama</span><span class="p">[</span><span class="s1">&#39;capacity_mw&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Još samo da tabelu sortiramo po broju elektrana.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>capacity_mw</th>
      <th>count</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>USA</th>
      <td>1.204638e+06</td>
      <td>9833</td>
    </tr>
    <tr>
      <th>CHN</th>
      <td>1.415067e+06</td>
      <td>4235</td>
    </tr>
    <tr>
      <th>GBR</th>
      <td>9.715528e+04</td>
      <td>2751</td>
    </tr>
    <tr>
      <th>BRA</th>
      <td>1.475893e+05</td>
      <td>2360</td>
    </tr>
    <tr>
      <th>FRA</th>
      <td>1.106159e+05</td>
      <td>2155</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>PSE</th>
      <td>7.600000e+00</td>
      <td>1</td>
    </tr>
    <tr>
      <th>DJI</th>
      <td>1.073320e+02</td>
      <td>1</td>
    </tr>
    <tr>
      <th>SUR</th>
      <td>5.000000e+00</td>
      <td>1</td>
    </tr>
    <tr>
      <th>ESH</th>
      <td>2.340000e+01</td>
      <td>1</td>
    </tr>
    <tr>
      <th>GNB</th>
      <td>1.823700e+01</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>167 rows × 2 columns</p>
</div></div></div>
</div>
<p>Sada vidimo kolika je ukupna snaga elektrana u SAD, Kini, Britaniji… Ukupno, za ceo svet to može da se sabere i dobijamo 5.7 teravata snage.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf</span><span class="o">.</span><span class="n">capacity_mw</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5706975.447257
</pre></div>
</div>
</div>
</div>
</section>
<section id="povezivanje-tabela">
<h2>Povezivanje tabela<a class="headerlink" href="#povezivanje-tabela" title="Permalink to this headline">¶</a></h2>
<p>Nemamo uvek sve potrebne podatke u jednoj tabeli. Na primer, u tabeli sa elektranama nemamo podatak o tome na kom se kontinentu nalaze elektrane, a baš nas interesuje da vidimo koliko koji kontinent proizvodi struje. Rešenje je da nađemo drugu tabelu u kojoj imamo podatke na kom je kontinentu koja zemlja pa da te dve tabele povežemo. Važno je da nađemo tabelu koja ima na isti način zapisane vrednosti po kojima hoćemo da povežemo tabele. Ako u jednoj piše “United Kingdom” a u drugoj “Great Britain” to će biti muka za povezivanje. Baš zato su međunarodne agencije standardizovale nazive i oznake za zemlje, regije, opštine itd. Da vidimo šta piše u jednoj takvoj <a class="reference external" href="https://datahub.io/JohnSnowLabs/country-and-continent-codes-list/r/country-and-continent-codes-list-csv.csv">tabeli</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zemlje</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/country-and-continent-codes-list.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">zemlje</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Continent_Name</th>
      <th>Continent_Code</th>
      <th>Country_Name</th>
      <th>Two_Letter_Country_Code</th>
      <th>Three_Letter_Country_Code</th>
      <th>Country_Number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Asia</td>
      <td>AS</td>
      <td>Afghanistan, Islamic Republic of</td>
      <td>AF</td>
      <td>AFG</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Europe</td>
      <td>EU</td>
      <td>Albania, Republic of</td>
      <td>AL</td>
      <td>ALB</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Antarctica</td>
      <td>AN</td>
      <td>Antarctica (the territory South of 60 deg S)</td>
      <td>AQ</td>
      <td>ATA</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Africa</td>
      <td>AF</td>
      <td>Algeria, People's Democratic Republic of</td>
      <td>DZ</td>
      <td>DZA</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Oceania</td>
      <td>OC</td>
      <td>American Samoa</td>
      <td>AS</td>
      <td>ASM</td>
      <td>16.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Europe</td>
      <td>EU</td>
      <td>Andorra, Principality of</td>
      <td>AD</td>
      <td>AND</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Africa</td>
      <td>AF</td>
      <td>Angola, Republic of</td>
      <td>AO</td>
      <td>AGO</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>North America</td>
      <td>NaN</td>
      <td>Antigua and Barbuda</td>
      <td>AG</td>
      <td>ATG</td>
      <td>28.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Dovoljno je baciti pogled na tabelu pa da vidimo da je u jednoj tabeli “Afghanistan”, a u drugoj “Afghanistan, Islamic Republic of”. Srećom, kolone <strong>country</strong> u prvoj i <strong>Three_Letter_Country_Code</strong> imaju iste troslovne oznake: “AFG” je na oba mesta. Nadamo se da se podaci podudaraju i za druge zemlje.</p>
<p>Pomoću funkcije <code class="docutils literal notranslate"><span class="pre">merge()</span></code> iz <strong>pandas</strong> biblioteke možemo da spojimo dve tabele. To možemo da uradimo tako što od dve tabele pravimo treću ili tako što jednu dopunjujemo podacima iz druge. Svejedno, argumenti funkcije treba da budu nazivi tabela i kolona po kojima ih povezujemo. Lakše je ako se te kolone zovu isto u obe tabele. Onda je dovoljan jedan argument, npr. <code class="docutils literal notranslate"><span class="pre">on=&quot;country&quot;</span></code>, ali to kod nas nije slučaj pa smo naveli oba: <code class="docutils literal notranslate"><span class="pre">left_on</span></code> i <code class="docutils literal notranslate"><span class="pre">right_on</span></code>. Imajte u vidu da se liste po kojima povezujemo tabele možda ne poklapaju savršeno. Podrazumevani argument je <code class="docutils literal notranslate"><span class="pre">how=&quot;inner&quot;</span></code> što znači da će nova tabela imati samo one redove koje se nalaze i u prvoj i u drugoj. To možemo da menjamo, ali se nećemo sad u to upuštati.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf</span><span class="o">=</span><span class="n">gdf</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">zemlje</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;country&quot;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;Three_Letter_Country_Code&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>capacity_mw</th>
      <th>count</th>
      <th>Continent_Name</th>
      <th>Continent_Code</th>
      <th>Country_Name</th>
      <th>Two_Letter_Country_Code</th>
      <th>Three_Letter_Country_Code</th>
      <th>Country_Number</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>300.550</td>
      <td>9</td>
      <td>Asia</td>
      <td>AS</td>
      <td>Afghanistan, Islamic Republic of</td>
      <td>AF</td>
      <td>AFG</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1071.180</td>
      <td>14</td>
      <td>Africa</td>
      <td>AF</td>
      <td>Angola, Republic of</td>
      <td>AO</td>
      <td>AGO</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1529.000</td>
      <td>8</td>
      <td>Europe</td>
      <td>EU</td>
      <td>Albania, Republic of</td>
      <td>AL</td>
      <td>ALB</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>30327.000</td>
      <td>30</td>
      <td>Asia</td>
      <td>AS</td>
      <td>United Arab Emirates</td>
      <td>AE</td>
      <td>ARE</td>
      <td>784.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>32913.079</td>
      <td>236</td>
      <td>South America</td>
      <td>SA</td>
      <td>Argentina, Argentine Republic</td>
      <td>AR</td>
      <td>ARG</td>
      <td>32.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>168</th>
      <td>41350.490</td>
      <td>236</td>
      <td>Asia</td>
      <td>AS</td>
      <td>Vietnam, Socialist Republic of</td>
      <td>VN</td>
      <td>VNM</td>
      <td>704.0</td>
    </tr>
    <tr>
      <th>169</th>
      <td>1045.000</td>
      <td>7</td>
      <td>Asia</td>
      <td>AS</td>
      <td>Yemen</td>
      <td>YE</td>
      <td>YEM</td>
      <td>887.0</td>
    </tr>
    <tr>
      <th>170</th>
      <td>50422.700</td>
      <td>104</td>
      <td>Africa</td>
      <td>AF</td>
      <td>South Africa, Republic of</td>
      <td>ZA</td>
      <td>ZAF</td>
      <td>710.0</td>
    </tr>
    <tr>
      <th>171</th>
      <td>2689.337</td>
      <td>15</td>
      <td>Africa</td>
      <td>AF</td>
      <td>Zambia, Republic of</td>
      <td>ZM</td>
      <td>ZMB</td>
      <td>894.0</td>
    </tr>
    <tr>
      <th>172</th>
      <td>1670.000</td>
      <td>2</td>
      <td>Africa</td>
      <td>AF</td>
      <td>Zimbabwe, Republic of</td>
      <td>ZW</td>
      <td>ZWE</td>
      <td>716.0</td>
    </tr>
  </tbody>
</table>
<p>173 rows × 8 columns</p>
</div></div></div>
</div>
<p>Kako bismo sad od ovoga napravili tabelu sa brojem elektrana i ukupnom snagom po kontinentima? Opet ćemo grupisati podatke.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">po_kontinentima</span><span class="o">=</span><span class="n">gdf</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Continent_Name&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Istini za volju, ovo grupisanje nije savršeno. Ima zemalja koje su na dva kontinenta (npr. Rusija i Turska) pa se njihove elektrane broje dvaput. To bi moglo da se reši tako što njihove pojedinačne elektrane pridružujemo kontinentima, ali bi to sad bilo previše zametno. Za potrebe ove vežbe ćemo zanemariti grešku koju unosi tih nekoliko zemalja.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf2</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">po_kontinentima</span><span class="p">[</span><span class="s1">&#39;capacity_mw&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>capacity_mw</th>
    </tr>
    <tr>
      <th>Continent_Name</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Africa</th>
      <td>1.605328e+05</td>
    </tr>
    <tr>
      <th>Antarctica</th>
      <td>7.600000e+00</td>
    </tr>
    <tr>
      <th>Asia</th>
      <td>2.940987e+06</td>
    </tr>
    <tr>
      <th>Europe</th>
      <td>1.140829e+06</td>
    </tr>
    <tr>
      <th>North America</th>
      <td>1.430915e+06</td>
    </tr>
    <tr>
      <th>Oceania</th>
      <td>7.325085e+04</td>
    </tr>
    <tr>
      <th>South America</th>
      <td>2.716017e+05</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Bez mnogo analize vidimo da Evropa proizvodi sedam puta više struje nego Afrika. Mi ovde završavamo zajedničko istraživanje na temu elektrana. Sve ostalo prepuštamo vama za samostalni rad.</p>
</section>
<section id="snimanje-podataka">
<h2>Snimanje podataka<a class="headerlink" href="#snimanje-podataka" title="Permalink to this headline">¶</a></h2>
<p>Ostaje nam još samo jedna stvar koju moramo da uradimo pre nego što bude kasno – da snimimo rezultat. Pomoću fukcije <code class="docutils literal notranslate"><span class="pre">to_csv()</span></code> <em>DataFrame</em> ćemo lako snimiti kao CSV fajl.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gdf2</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;output/po_kontinentima.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="0%20Uvod.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Uvod</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="2%20Eksplorativna%20analiza%20podataka.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Eksplorativna analiza podataka</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Srđan Verbić<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>